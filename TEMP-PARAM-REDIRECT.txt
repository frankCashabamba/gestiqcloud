import React from 'react'
import { Navigate, useParams } from 'react-router-dom'

/**
 * Param-aware redirect that expands route patterns like '/:empresa/clientes'
 * using current URL params. Avoids literal ':empresa' leaking into the URL.
 */
export default function ParamRedirect({ to, replace = true }: { to: string; replace?: boolean }) {
  const params = useParams()
  let target = to
  // Replace all ":param" with matching values from params when present
  Object.entries(params).forEach(([k, v]) => {
    if (!v) return
    target = target.replace(new RegExp(`:${k}\b`, 'g'), encodeURIComponent(v))
  })
  return <Navigate to={target} replace={replace} />
}
