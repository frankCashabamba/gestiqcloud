<!DOCTYPE html>
<html>
<head>
  <title>Test Login API</title>
</head>
<body>
  <h1>Test Login</h1>
  <button onclick="testLogin()">Test Login</button>
  <pre id="output"></pre>

  <script>
    const API_BASE = 'https://api.gestiqcloud.com/api';
    const output = document.getElementById('output');

    async function testLogin() {
      output.textContent = 'Testing...\n';
      
      try {
        // Test CSRF first
        output.textContent += `\nFetching CSRF: ${API_BASE}/v1/admin/auth/csrf\n`;
        const csrfRes = await fetch(`${API_BASE}/v1/admin/auth/csrf`, {
          credentials: 'include',
          headers: { 'Accept': 'application/json' }
        });
        output.textContent += `CSRF Status: ${csrfRes.status}\n`;
        
        // Test Login
        output.textContent += `\nTesting Login: ${API_BASE}/v1/admin/auth/login\n`;
        const loginRes = await fetch(`${API_BASE}/v1/admin/auth/login`, {
          method: 'POST',
          credentials: 'include',
          headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json'
          },
          body: JSON.stringify({
            ident: 'admingestiqcloud',
            password: 'Admin.2025'
          })
        });
        
        output.textContent += `Login Status: ${loginRes.status}\n`;
        const data = await loginRes.json();
        output.textContent += `Response: ${JSON.stringify(data, null, 2)}\n`;
        
      } catch (err) {
        output.textContent += `\nError: ${err.message}\n`;
        output.textContent += `Stack: ${err.stack}\n`;
      }
    }
  </script>
</body>
</html>
